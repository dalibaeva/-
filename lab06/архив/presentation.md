---
## Front matter
lang: ru-RU
title: Лабораторная работа №6
author: |
	Алибаева Данагуль  \inst{1}
	
institute: |
	\inst{1}RUDN University, Moscow, Russian Federation
	
date: 2021 Moscow, Russia

## Formatting
toc: false
slide_level: 2
theme: metropolis
header-includes: 
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
aspectratio: 43
section-titles: true
---



## Прагматика выполнения лабораторной работы

Практические навыки работы в консоли с расширенными атрибутами файлов и правами доступа понадобятся для умения разграничения и избирательного управления доступом.

## Цель выполнения лабораторной работы

Развить навыки администрирования ОС Linux. Получить первое практическое знакомство с технологией SELinux. Проверить работу SELinx на практике совместно с веб-сервером Apache.

## Задачи выполнения лабораторной работы

1. Войти в систему с полученными учётными данными и убедится, что SELinux работает в режиме enforcing политики targeted.

2. Обратится с помощью браузера к веб-серверу, запущенному на компьютере, и убедится, что последний работает. Если не работает, запустить его так же, но с параметром start. 

3. Найти веб-сервер Apache в списке процессов, определить его контекст безопасности и занести эту информацию в отчёт. 

4. Посмотреть текущее состояние переключателей SELinux для Apache. Обратить внимание, что многие из них находятся в положении «off».

5. Посмотреть статистику по политике с помощью команды seinfo, также определить множество пользователей, ролей, типов. 

6. Определить тип файлов и поддиректорий, находящихся в директории /var/www.

7. Определить тип файлов, находящихся в директории /var/www/html

8. Определить круг пользователей, которым разрешено создание файлов в директории /var/www/html. 

## Задачи выполнения лабораторной работы

9. Создать от имени суперпользователя (так как в дистрибутиве после установки только ему разрешена запись в директорию) html-файл /var/www/html/test.html следующего содержания: Test

10. Проверить контекст созданного файла. Занести в отчёт контекст, присваиваемый по умолчанию вновь созданным файлам в директории /var/www/html. 

11. Обратиться к файлу через веб-сервер, введя в браузере адрес http://127.0.0.1/test.html. Убедится, что файл был успешно отображён. 

12. Изучить справку man httpd_selinux и выяснить, какие контексты файлов определены для httpd. Сопоставить их с типом файла test.html. 

13. Изменить контекст файла /var/www/html/test.html с httpd_sys_content_t на любой другой, к которому процесс httpd не должен иметь доступа, например, на samba_share_t. После этого проверить, что контекст поменялся. 

14. Попробовать ещё раз получить доступ к файлу через веб-сервер, введя в браузере адрес http://127.0.0.1/test.html. Должны получить сообщение об ошибке: Forbidden You don't have permission to access /test.html on this server. 

15. Проанализировать ситуацию. Почему файл не был отображён, если права доступа позволяют читать этот файл любому пользователю? Просмотреть log-файлы веб-сервера Apache. Также просмотреть системный лог-файл. Если в системе окажутся запущенными процессы setroubleshootd и audtd, то можно увидеть ошибки, аналогичные указанным выше, в файле /var/log/audit/audit.log. 

16. Попробовать запустить веб-сервер Apache на прослушивание ТСР-порта 81 (а не 80, как рекомендует IANA и прописано в /etc/services). Для этого в файле /etc/httpd/httpd.conf найти строчку Listen 80 и заменить её на Listen 81. 

## Задачи выполнения лабораторной работы

17. Выполнить перезапуск веб-сервера Apache. Произошёл сбой? Пояснить почему? 

18. Проанализирвать лог-файлы. Просмотреть файлы /var/log/http/error_log, /var/log/http/access_log и /var/log/audit/audit.log и выяснить, в каких файлах появились записи. 

19. Проверить список портов. Убедиться, что порт 81 появился в списке. 

20. Попробовать запустить веб-сервер Apache ещё раз. 

21. Вернуть контекст httpd_sys_cоntent__t к файлу /var/www/html/ test.html. После этого попробовать получить доступ к файлу через веб-сервер. Должны увидеть содержимое файла — слово «test». 

22. Исправить обратно конфигурационный файл apache, вернув Listen 80. 

23. Удалить привязку http_port_t к 81 порту и проверить, что порт 81 удалён. 

24. Удалить файл /var/www/html/test.html.

## Результаты выполнения лабораторной работы

1. Успешное обращение к файлу через веб-сервер 
 
![Обращение к файлу через веб-сервер](image/1_12.png){ #fig:001 width=70% }  

## Результаты выполнения лабораторной работы

2. Успешное получение доступа к файлу через веб-сервер

![Получение доступа к веб-серверу](image/1_27.png){ #fig:002 width=70% }  

## Вывод

Развила навыки администрирования ОС Linux. Получила первое практическое знакомство с технологией SELinux. Проверила работу SELinx на практике совместно с веб-сервером Apache. 

## {.standout}

Спасибо за внимание!
